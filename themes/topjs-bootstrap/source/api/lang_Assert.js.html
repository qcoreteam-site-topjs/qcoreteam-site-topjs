<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>lang/Assert.js - Documentation</title>

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="../css/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="../css/prettify.css">
    <link type="text/css" rel="stylesheet" href="../css/jsdoc.css">
    <link type="text/css" rel="stylesheet" href="../css/extra.css">
    <link type="text/css" rel="stylesheet" href="../css/common.css">
</head>
<body>
<header class="navbar navbar-fixed-top fixed-header fixed-header-active header hidden-sm-down">
    <nav class="navbar navbar-light">

        <div class="">
            <button class="navbar-toggler hidden-lg-up float-xs-right" type="button" data-toggle="collapse"
                    data-target="#navbarResponsive"
                    aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"></button>
            <a href="/"><img class="navbar-brand logo" src="../images/logo-green.png"></a>

            <div class="collapse navbar-toggleable-md float-lg-right" id="navbarResponsive">
                <ul class="nav navbar-nav float-lg-right">
                    <li class="nav-item"><a class="nav-link" href="/" >首页</a></li><li class="nav-item"><a class="nav-link" href="/docs/v0.0.1/" >手册</a></li><li class="nav-item"><a class="nav-link" href="/api/" >API文档</a></li><li class="nav-item"><a class="nav-link" href="/categories/blog/" >博客</a></li><li class="nav-item"><a class="nav-link" href="/categories/devel/" >开发日志</a></li><li class="nav-item"><a class="nav-link" href="/about/" >关于我们</a></li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="hidden-md-up sm-header">
    <div class="toggler" id="slideClose"></div>
    <img src="../images/logo-green.png">
</div>
<div class="api-container clearfix">
    <nav>
        <div class="category hidden-md-up">
            <a href="/">首页</a>
            <a href="/docs/v0.0.1/">手册</a>
            <a href="/api/">API文档</a>
            <a href="/categories/blog">博客</a>
            <a href="/categories/devel">开发日志</a>
            <a href="/about">关于我们</a>
        </div>
        <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul class = "entry-type-namespaces"><li><a href="TopJs.html">TopJs</a><ul class='members'><li data-type='member' class='entry-type-class'><a href="TopJs.Array.html">Array</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Assert.html">Assert</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Base.html">Base</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Class.html">Class</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.ClassManager.html">ClassManager</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Config.html">Config</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Date.html">Date</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Error.html">Error</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Function.html">Function</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Loader.html">Loader</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Number.html">Number</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Object.html">Object</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.String.html">String</a></li><li data-type='member' class='entry-type-class'><a href="TopJs.Version.html">Version</a></li></ul></li><li><a href="TopJs.kernel.html">TopJs.kernel</a></li></ul><h3>Global</h3><ul><li><a href="global.html#callParent">callParent</a></li><li><a href="global.html#callSuper">callSuper</a></li><li><a href="global.html#clearPropertiesOnDestroy">clearPropertiesOnDestroy</a></li><li><a href="global.html#destroyed">destroyed</a></li><li><a href="global.html#isConfiguring">isConfiguring</a></li><li><a href="global.html#isFirstInstance">isFirstInstance</a></li><li><a href="global.html#isInstance">isInstance</a></li><li><a href="global.html#statics">statics</a></li></ul>
    </nav>
    <div id="main">
        
        <h1 class="page-title">lang/Assert.js</h1>
        

        



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * TopJs Framework (http://www.topjs.org/)
 *
 * @link      http://github.com/qcoreteam/topjs for the canonical source repository
 * @copyright Copyright (c) 2016-2017 QCoreTeam (http://www.qcoreteam.org)
 * @license   http://www.topjs.org/license/new-bsd New BSD License
 */
"use strict";
let Assert = TopJs.Assert = {};
/**
 * @class TopJs.Assert
 * @singleton
 * @classdesc
 * 这个类提供一个有用的诊断信息，经常用在`debug hooks`区域
 * ```javascript
 * TopJs.define("Foo.bar.Class", {
     *    debugHooks: {
     *       method: function (a) {
     *          TopJs.Assert.truthy(a, "Expected "a" to be truthy");
     *       },
     *       foo: function (object) {
     *          TopJs.Assert.isFunctionProp(object, "doSomething");
     *       }
     *     }
     * });
 * ```
 * **注意:** 这个类里面的方法在打包的时候需要移除，所以请在`debug comment`区域使用或者在
 * `debughooks`里面使用
 *
 * 如下从`TopJs`探测得到的方法被自动包装，加入`assert`相关的语句
 *
 *  * `isEmpty`
 *  * `isArray`
 *  * `isDate`
 *  * `isObject`
 *  * `isSimpleObject`
 *  * `isPrimitive`
 *  * `isFunction`
 *  * `isNumber`
 *  * `isNumeric`
 *  * `isString`
 *  * `isBoolean`
 *  * `isDefined`
 *  * `isIterable`
 *
 * 以上方法都有一个加了`Prop`后缀的方法，方便检测对象上的属性
 * 例如：
 * ```javascript
 * TopJs.Assert.isFunction(object.foo);
 * TopJs.Assert.isFunctionProp(object, 'foo');
 * ```
 *
 * 上面方法列表同样有否定断言方法
 *
 *  * `isNotEmpty`
 *  * `isNotArray`
 *  * `isNotDate`
 *  * `isNotObject`
 *  * `isNotSimpleObject`
 *  * `isNotPrimitive`
 *  * `isNotFunction`
 *  * `isNotNumber`
 *  * `isNotNumeric`
 *  * `isNotString`
 *  * `isNotBoolean`
 *  * `isNotDefined`
 *  * `isNotIterable`
 *
 */
TopJs.apply(Assert, /** @lends TopJs.Assert */{
    /**
     * 检查第一个参数是否`falsey`，如果不是则抛出`Error`
     *
     * @param {Object} b 需要检查的对象
     * @param {String} msg 抛出异常的值
     */
    falsey(b, msg)
    {
        if (b) {
            TopJs.raise(msg || (`期望得到一个"falsey"值，但是值${b}。`))
        }
    },

    /**
     * 检查第一个参数的属性是否`falsey`，如果不是则抛出`Error`
     *
     * @param {Object} object 等待检查的对象
     * @param {String} property 需要检查的属性名称
     */
    falseyProp(object, property)
    {
        TopJs.Assert.truthy(object);
        let b = object[property];
        if (b) {
            if (object.$_class_name_$) {
                property = object.$_class_name_$ + '#' + property;
            }
            TopJs.raise(`期望${property}是一个"falsey"值，但是值${b}。`);
        }
    },

    /**
     * 判断第一个参数是否为`truthy`值，如果不是抛出`Error`
     *
     * @param {Object} b 需要检查的对象
     * @param {String} msg 抛出异常的值
     */
    truthy(b, msg)
    {
        if (b) {
            TopJs.raise(msg || (`期望得到一个"truthy"值，但是值${b}。`))
        }
    },

    /**
     * 检查第一个参数的属性是否`truthy`，如果不是则抛出`Error`
     *
     * @param {Object} object 等待检查的对象
     * @param {String} property 需要检查的属性名称
     */
    truthyProp(object, property)
    {
        TopJs.Assert.truthy(object);
        let b = object[property];
        if (b) {
            if (object.$_class_name_$) {
                property = object.$_class_name_$ + '#' + property;
            }
            TopJs.raise(`期望${property}是一个"truthy"值，但是值${b}。`);
        }
    }
});

function make_assert(name, kind)
{
    let testFn = TopJs[name],
        def;
    return function (value, msg)
    {
        if (!testFn(value)) {
            TopJs.raise(msg || def ||
                (def = `期望值是${kind}`));
        }
    };
}

function make_assert_prop(name, kind)
{
    let testFn = TopJs[name],
        def;
    return function (object, prop)
    {
        TopJs.Assert.truthy(object);
        if (!testFn(object[prop])) {
            TopJs.raise(def || (def = '期望属性 ' +
                    (object.$_class_name_$ ? object.$_class_name_$ + '#' : '') +
                    prop + ' 的值是 ' + kind));
        }
    };
}

function make_not_assert(name, kind)
{
    let testFn = TopJs[name],
        def;
    return function (value, msg)
    {
        if (testFn(value)) {
            TopJs.raise(msg || def ||
                (def = `期望值不是${kind}`));
        }
    };
}

function make_not_assert_prop(name, kind)
{
    let testFn = TopJs[name],
        def;
    return function (object, prop)
    {
        TopJs.Assert.truthy(object);
        if (testFn(object[prop])) {
            TopJs.raise(def || (def = '期望属性 ' +
                    (object.$_class_name_$ ? object.$_class_name_$ + '#' : '') +
                    prop + ' 值不是 ' + kind));
        }
    };
}

for (let name in TopJs) {
    if (name.substring(0, 2) == "is" &amp;&amp; TopJs.isFunction(TopJs[name])) {
        let kind = name.substring(2);
        TopJs.Assert[name] = make_assert(name, kind);
        TopJs.Assert[name + 'Prop'] = make_assert_prop(name, kind);
        TopJs.Assert['isNot' + kind] = make_not_assert(name, kind);
        TopJs.Assert['isNot' + kind + 'Prop'] = make_not_assert_prop(name, kind);
    }
}</code></pre>
        </article>
    </section>




    </div>
</div>



<script src="../js/jquery.min.js"></script>
<script src="../js/tether.min.js" crossorigin="anonymous"></script>

<script src="../js/prettify/prettify.js"></script>
<script src="../js/prettify/lang-css.js"></script>
<script>prettyPrint();</script>

<script src="../js/bootstrap.min.js" crossorigin="anonymous"></script>
<script src="../js/linenumber.js"></script>
<script src="../js/maodian.js"></script>

<script src="../js/extra.js"></script>
<script src="../js/common.js"></script>
</body>
</html>
